objects:
  - user: Individual 
  - cohabitants: DAList.using(object_type=Individual) 
---
mandatory: true
code:  |

  if not appeal_legal_aid: 
    live_in_alberta
    family_law
    criminal_law
    legal_in_alberta
  
  if not afford_lawyer and have_lawyer:
    if_lawyer_still_here

---
mandatory: true
question: Here is your document.
subquestion: Please print it or email it to yourself. 
attachment: 
  - name: Legal Aid Document
    filename: legal_aid_inquiry_doc
    content:  |
    
      Hello ${ user }
      
      Below are information you have entered for this self assessment:
      
      % if len(cohabitants) > 0: 
      * You live with the following people: ${ cohabitants }. 
      % else: 
      * You do not live with anyone. 
      % endif

      % if have_lawyer:
      * You indicated that you have a lawyer.
      % else:
      * You indicated that you do not have a lawyer. 
      % endif
      
      % if afford_lawyer:
      * You indicated that you have sufficient income to afford a lawyer. 
      % else:
      * You indicated that you do not have sufficient income to afford a lawyer. 
      % endif
      
      % if not afford_lawyer and have_lawyer:
      * You indicated that you have a lawyer acting on your behalf for this matter as ${ if_lawyer_still_here }.
      % else:
      % endif
      
      % if appeal_legal_aid:
      * You indicated that you had received Legal Aid Alberta's assistance with this legal matter. 
      % else:
      * You indicated that your matter is a family law matter as ${ family_law }.
      * You indicated that your matter is a criminal law matter as ${ criminal_law }.
      * You indicated that you live in Alberta = ${ live_in_alberta }.
      * You indicated that your legal matter is in Alberta as ${ legal_in_alberta }.
      % endif 
      
      % if eligible_legal_aid:
      Based on the information you entered above, you qualify for Legal Aid assistance. Please contact us for next steps at Phone/email. 
      % else: 
      Based on the information you entered above, you do no qualify for Legal Aid assistance. If you wish to seek clarification or additional assistance please contact us at Phone/email. 
      % endif 
    
      Date of inquiry ${ format_date(date_of_inquiry, format='EEEE, MMMM d, yyyy') }, which can also be written as ${ format_date(date_of_inquiry, format="yyyy-MM-dd") }. 
      
      
      ${ user.signature }
      Please sign
---
# below is general user information and date
---
generic object:  Individual
question:  What is your name?
fields:
  - First Name: x.name.first
  - Last Name: x.name.last
---
question:  Do you live with anyone?
yesno:  cohabitants.there_are_any
---
question:  Do you live with anyone else?
yesno:  cohabitants.there_is_another
---
question:  What is the date of inquiry (today's date)? 
fields: 
  - Date of inquiry: date_of_inquiry
    datatype: date 
---
question:  Please sign
signature:  user.signature 
# below are qualification questions
---
question:  Do you have a lawyer?
yesno:  have_lawyer
---
question:  Do you have enough income to seek assistance from a lawyer?
yesno:  afford_lawyer
---
question: If you have a lawyer working on your file or have approached a lawyer seeking assistance for your file, is that lawyer currently acting on your behalf for this matter?
yesno: if_lawyer_still_here
---
question: Is your legal matter located in Alberta?
yesno: legal_in_alberta
---
question: Is your legal matter a family law matter?
yesno: family_law
---
question: Is your legal matter a criminal law matter?
yesno: criminal_law 
---
question: Is your matter an appeal of a matter that you received assistance from Legal Aid Alberta?
yesno: appeal_legal_aid
---
question: Do you live in Alberta? 
yesno: live_in_alberta
---
# below are codes for rules and determining eligibility 
---
code:  |
  if have_lawyer or afford_lawyer:
    satisfy_unrepresented = False
  else:
    satisfy_unrepresented = True
---
code:  |
  if live_in_alberta:
    satisfy_residency = True
  else:
    satisfy_residency = False
---
code:  |
  if ((family_law or criminal_law) and legal_in_alberta) or appeal_legal_aid:
    matter_within_assistance_range = True
  else:
    matter_within_assistance_range = False
---
code:  |
  if satisfy_unrepresented and satisfy_residency and matter_within_assistance_range:
    eligible_legal_aid = True
  else:
    eligible_legal_aid = False